datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl"]
}

model Image {
  hash           String @id @db.VarChar(40)
  image_resource String @db.VarChar(40)
  width          Int    @db.Integer
  height         Int    @db.Integer

  ImageResource ImageResource? @relation(fields: [image_resource], references: [hash])
}

enum ImageResourceSource {
  SPOTIFY
  DEEZER
  LASTFM
}

model ImageResource {
  hash     String              @id @db.VarChar(40)
  explicit Boolean
  active   Boolean
  source   ImageResourceSource

  color_palette String[]

  images Image[]

  artists Artist[]

  created_at DateTime
}

model Artist {
  hash       String          @id @db.VarChar(40)
  name       String          @db.Text
  spotify_id String?         @db.VarChar(22)
  deezer_id  Int
  resources  ImageResource[]
  genres     String[]        @db.Text
  tags       String[]        @db.Text
  similar    String[]        @db.Text

  created_at DateTime
  updated_at DateTime
}

model Album {
  hash    String @id @db.VarChar(40)
  name    String @db.Text
  artists String @db.Text

  spotify_id String? @db.VarChar(22)
  deezer_id  String? @db.VarChar(32)

  spotify_covers        String? @db.Text
  spotify_covers_colors String? @db.Text
  deezer_cover          String? @db.Text
  deezer_covers_colors  String? @db.Text

  release_date String? @db.VarChar(16)
  cached_at    String  @db.VarChar(16)
}

model Track {
  hash String @id @db.VarChar(40)

  name    String @db.Text
  artists String @db.Text
  album   String @db.Text

  spotify_id String? @db.VarChar(22)
  deezer_id  String? @db.VarChar(32)
  genius_id  String? @db.VarChar(32)

  spotify_covers        String? @db.Text
  spotify_covers_colors String? @db.Text
  deezer_cover          String? @db.Text
  deezer_covers_colors  String? @db.Text

  duration Int?    @db.Integer
  preview  String? @db.VarChar(255)

  cached_at String @db.VarChar(16)
}

model TrackFeatures {
  spotify_id String @id @db.VarChar(22)

  danceability     Float @db.DoublePrecision
  energy           Float @db.DoublePrecision
  loudness         Float @db.DoublePrecision
  speechiness      Float @db.DoublePrecision
  acousticness     Float @db.DoublePrecision
  instrumentalness Float @db.DoublePrecision
  liveness         Float @db.DoublePrecision
  valence          Float @db.DoublePrecision
  tempo            Float @db.DoublePrecision
}
